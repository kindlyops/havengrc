(function(){var ChargeBee={};ChargeBee._env={protocol:"https",hostSuffix:".chargebee.com",apiPath:"/api/js/v1",timeout:40000};ChargeBee.configure=function(conf){ChargeBee._util.extend(true,ChargeBee._env,conf)};ChargeBee._endpoints={subscription:[["create","POST","/subscriptions",null,false]],estimate:[["create_subscription","POST","/estimates","/create_subscription",false],["update_subscription","POST","/estimates","/update_subscription",false]],plan:[["list","GET","/plans",null,false],["retrieve","GET","/plans",null,true]],addon:[["list","GET","/addons",null,false],["retrieve","GET","/addons",null,true]],hosted_page:[["checkout_new","POST","/hosted_pages","/checkout_new",false]]};function createApiFunc(apiCall){return function(){return new RequestWrapper(arguments,apiCall)}}function RequestWrapper(args,apiCall){this.args=args;this.apiCall=apiCall;if(this.apiCall[4]){validateIdParam(this.args[0])}}RequestWrapper.prototype.request=function(callBack){var urlIdParam=this.apiCall[4]?this.args[0]:null;var params=this.apiCall[4]?this.args[1]:this.args[0];if(!ChargeBee._util.isFunction(callBack)){throw new Error(("the callback parameter passed is incorrect."))}return ChargeBee.core.ajax(callBack,this.apiCall[1],this.apiCall[2],this.apiCall[3],urlIdParam,params)};function validateIdParam(idParam){if(typeof idParam==="undefined"||typeof idParam!=="string"){throw new Error("the required id parameter missing or wrong")}return idParam}(function(){for(var res in ChargeBee._endpoints){ChargeBee[res]={};var apiCalls=ChargeBee._endpoints[res];for(var apiIdx=0;apiIdx<apiCalls.length;apiIdx++){var apiCall=apiCalls[apiIdx];ChargeBee[res][apiCall[0]]=createApiFunc(apiCall)}}})();ChargeBee.core=(function(){var coreRef={};var requestId=0;coreRef.ajax=function(callBack,httpMethod,urlPrefix,urlSuffix,urlIdParam,params){if(typeof params==="undefined"||params===null){params={}}params._jsapi_key=ChargeBee._env.api_key;params._jsapi_method=httpMethod;return jsonpAjax({url:getApiURL(urlPrefix,urlSuffix,urlIdParam),data:params,callBack:callBack,timeout:ChargeBee._env.timeout})};function clearScript(refs){clearTimeout(refs.abortTimeout);if(refs.scriptTag.parentNode!==null){refs.scriptTag.parentNode.removeChild(refs.scriptTag)}if(typeof window[refs.jsonpName]!=="undefined"){try{delete window[refs.jsonpName]}catch(e){window[refs.jsonpName]=void 0}}}function requestAborted(refs,httpCode,errorCode,message){clearScript(refs);throwError(refs.options.callBack,httpCode,errorCode,message)}var jsonpAjax=function(options){var refs={options:options};refs.jsonpName="cbjsonp_"+new Date().getTime()+"_"+(requestId++);refs.scriptTag=document.createElement("script");refs.scriptTag.onerror=function(){requestAborted(refs,500,"js_scripttag_onerror"," 'onerror' invoked when trying to call the api via script tag")};window[refs.jsonpName]=function(response,status){clearScript(refs);return options.callBack(status,response)};options.data._jsapi_callback=refs.jsonpName;refs.scriptTag.src=options.url+"?"+encodeParams(options.data);var headTag=document.getElementsByTagName("head")[0];if(typeof headTag==="undefined"){throw new Error("the head tag is not defined.")}headTag.appendChild(refs.scriptTag);if(options.timeout>0){refs.abortTimeout=setTimeout(function(){requestAborted(refs,504,"js_timeout","request timed out.")},options.timeout)}};function getApiURL(urlPrefix,urlSuffix,urlIdParam){var ce=ChargeBee._env;if(typeof ce.api_key==="undefined"||typeof ce.site==="undefined"){throw new Error("your site or api key is not configured.")}return ce.protocol+"://"+ce.site+ce.hostSuffix+ce.apiPath+urlPrefix+(urlIdParam!==null?"/"+encodeURIComponent(urlIdParam):"")+(urlSuffix!==null?urlSuffix:"")}var encodeParams=function(paramObj,serialized,scope,index){var key,value;if(typeof serialized==="undefined"||serialized===null){serialized=[]}for(key in paramObj){value=paramObj[key];if(scope){key=""+scope+"["+key+"]"}if(typeof index!=="undefined"&&index!==null){key=key+"["+index+"]"}if(ChargeBee._util.isArray(value)){for(var arrIdx=0;arrIdx<value.length;arrIdx++){if(typeof value[arrIdx]==="object"||ChargeBee._util.isArray(value[arrIdx])){encodeParams(value[arrIdx],serialized,key,arrIdx)}else{if(typeof value[arrIdx]!=="undefined"&&ChargeBee._util.trim(value[arrIdx])!==""){serialized.push(""+key+"="+(encodeURIComponent(value[arrIdx])))}}}}else{if(typeof value==="object"&&!ChargeBee._util.isArray(value)){encodeParams(value,serialized,key)}else{if(typeof value!=="undefined"&&ChargeBee._util.trim(value)!==""){serialized.push(""+key+"="+(encodeURIComponent(value)))}}}}return serialized.join("&").replace(/%20/g,"+")};var throwError=function(callBack,httpCode,errorCode,message){var error={http_code:httpCode,error_code:errorCode,message:message};return callBack(httpCode,error)};return coreRef}).call(this);ChargeBee._util=(function(){var util={};util.extend=function(deep,target,copy){util.extendsFn.call(this,deep,target,copy)};util.extendsFn=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&typeof target!=="function"){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!==null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(typeof copy==="object"||(copyIsArray=(util.isArray(copy))))){if(copyIsArray){copyIsArray=false;clone=src&&util.isArray(src)?src:[]}else{clone=src&&typeof src==="object"?src:{}}target[name]=util.extend.call(this,deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};util.indexOf=function(array,item){if(![].indexOf()){for(var i=0;i<array.length;i++){if(array[i]===item){return i}}return -1}else{return array.indexOf(item)}};util.trim=function(str){return str!==""?str:str.replace(/^\s+|\s+$/g,"")};util.isEmptyObject=function(obj){var name;for(name in obj){return false}return true};util.isNotUndefinedNEmpty=function(obj){if(typeof obj!=="undefined"&&!util.isEmptyObject(obj)){return true}return false};util.isArray=Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};util.isFunction=function(obj){return typeof obj==="function"};util.isUndefined=function(obj){if(typeof obj==="undefined"){return true}return false};util.handleCallback=function(){var scopeArgs=arguments[0];var allCallbacks=arguments[1];var callBacks=arguments[2];var argumentsArray=Array.prototype.slice.call(arguments,0);var args=argumentsArray.slice(3,argumentsArray.length);if(allCallbacks.hasOwnProperty(callBacks)){allCallbacks[callBacks].apply(scopeArgs,args)}};return util}).call(this);window.ChargeBee=ChargeBee;var iframePackage={};iframePackage.core=(function(){var ChargeBee=arguments[0];var CbEmbed={};var handleCallback=ChargeBee._util.handleCallback;var intervalId,lastHash,attachedCallback,lastAttachedCallback,window=this;var receiveMessage=function(callback,origin){if(window.postMessage){if(callback){attachedCallback=function(e){if((typeof origin==="string"&&e.origin!==origin)){return false}callback(e)}}if(window.addEventListener){if(typeof lastAttachedCallback!=="undefined"){window.removeEventListener("message",lastAttachedCallback,false)}window[callback?"addEventListener":"removeEventListener"]("message",attachedCallback,false)}else{if(typeof lastAttachedCallback!=="undefined"){window.detachEvent("onmessage",lastAttachedCallback)}window[callback?"attachEvent":"detachEvent"]("onmessage",attachedCallback)}lastAttachedCallback=attachedCallback}else{intervalId&&clearInterval(intervalId);intervalId=null;if(callback){intervalId=setInterval(function(){var hash=document.location.hash,re=/^#?\d+&/;if(hash!==lastHash&&re.test(hash)){lastHash=hash;callback({data:hash.replace(re,"")})}},100)}}};var defSettings={url:null,site:null,hostSuffix:".chargebee.com",src:null,protocol:"https",iframe:null,allowedCallbacks:["addIframe","onLoad","onResize","onSubmit","onSuccess","onCancel","onError"],userSettings:{}};var messageChannel=function(message){var messObj=JSON.parse(message.data);var d=defSettings;if(messObj.hasOwnProperty("onload")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[1],d.iframe,parseInt(messObj.width),parseInt(messObj.height))}else{if(messObj.hasOwnProperty("resize")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[2],d.iframe,parseInt(messObj.width),parseInt(messObj.height))}else{if(messObj.hasOwnProperty("onSubmit")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[3],d.iframe)}else{if(messObj.hasOwnProperty("success")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[4],d.iframe,messObj.successMessage)}else{if(messObj.hasOwnProperty("cancel")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[5],d.iframe)}else{if(messObj.hasOwnProperty("error")){handleCallback(d.userSettings,CbEmbed.callbacks,d.allowedCallbacks[6],d.iframe,messObj.errorObject)}}}}}}};ChargeBee.embed=function(url,site){return new EmbedFrame(url,site)};var EmbedFrame=function(url,site){this.url=url;this.site=site;validate(this.url,this.site)};EmbedFrame.prototype.load=function(settings){localTestingConfig(settings);if(ChargeBee._util.isUndefined(settings)){defSettings.userSettings=settings}this.callbacks=processCallback(settings);execute(this.url,this.site,this.callbacks)};var processCallback=function(settings){var callbacks={};if(ChargeBee._util.isUndefined(settings)){return callbacks}var allowedCallback=defSettings.allowedCallbacks;for(var i=0;i<allowedCallback.length;i++){if(ChargeBee._util.isFunction(settings[allowedCallback[i]])){callbacks[allowedCallback[i]]=settings[allowedCallback[i]]}}return callbacks};var execute=function(url,site,callbacks){defSettings.url=url;defSettings.site=site;CbEmbed.callbacks=callbacks;_execute()};var _execute=function(){receiveMessage(messageChannel,defSettings.protocol+"://"+defSettings.site+defSettings.hostSuffix);var iframe=document.createElement("iframe");iframe.setAttribute("scrolling","no");iframe.setAttribute("style","visibility:hidden;");defSettings.src=defSettings.url+"#"+encodeURIComponent(document.location.href);iframe.setAttribute("src",defSettings.src);defSettings.iframe=iframe;handleCallback(defSettings.userSettings,CbEmbed.callbacks,defSettings.allowedCallbacks[0],iframe)};var localTestingConfig=function(settings){if(!ChargeBee._util.isUndefined(settings.hostSuffix)){defSettings.hostSuffix=settings.hostSuffix}if(!ChargeBee._util.isUndefined(settings.protocol)){defSettings.protocol=settings.protocol}};var validate=function(url,site){if(ChargeBee._util.isUndefined(url)){throw new Error("url is required parameter")}if(ChargeBee._util.isUndefined(site)){throw new Error("site is required parameter")}}}).call(window,window.ChargeBee);iframePackage.bootstrap=(function(){var ChargeBee=arguments[0];var handleCallback=ChargeBee._util.handleCallback;var allowedCallbacks=["onLoad","onSubmit","onSuccess","onCancel","onError"];var modalSettings={};var bootstrapModalHandler={addIframe:function(iframe){$(jq(modalSettings.modalId)).attr("style","visibility: hidden;height:100%;");$(jq(modalSettings.modalId)).modal({backdrop:"static"});$(jq(modalSettings.modalId)).find("[data-cb-modal-body]").empty();$(jq(modalSettings.modalId)).find("[data-cb-modal-body]").append($(iframe))},onLoad:function(iframe,width,height){$(iframe).attr("style","width:100%;height:"+height+"px;border: none;overflow: hidden;");$(jq(modalSettings.modalId)).attr("style","visibility: visible; display: block;");handleCallback(modalSettings.userSettings,modalSettings.callbacks,allowedCallbacks[0])},onResize:function(iframe,width,height){$(iframe).attr("style","width:100%; height:"+height+"px;border: none;overflow: hidden;")},onSubmit:function(iframe){handleCallback(modalSettings.userSettings,modalSettings.callbacks,allowedCallbacks[1])},onSuccess:function(iframe,message){closeModal();handleCallback(modalSettings.userSettings,modalSettings.callbacks,allowedCallbacks[2],message)},onCancel:function(iframe){closeModal();handleCallback(modalSettings.userSettings,modalSettings.callbacks,allowedCallbacks[3])},onError:function(iframe,errorObject){handleCallback(modalSettings.userSettings,modalSettings.callbacks,allowedCallbacks[4],errorObject)}};var closeModal=function(){$(jq(modalSettings.modalId)).modal("hide");$(jq(modalSettings.modalId)).find("[data-cb-modal-body]").empty()};ChargeBee.bootStrapModal=function(url,site,modalId){validateRequired();return new EmbedFrameModal(url,site,modalId)};var EmbedFrameModal=function(url,site,modalId){this.emebedFrame=ChargeBee.embed(url,site);this.modalId=modalId;validateModalId(this.modalId)};EmbedFrameModal.prototype.load=function(settings){setModalSettings(this.modalId,settings);this.emebedFrame.load(bootstrapModalHandler)};var setModalSettings=function(modalId,settings){if(typeof settings.hostSuffix!=="undefined"){bootstrapModalHandler.hostSuffix=settings.hostSuffix}if(typeof settings.protocol!=="undefined"){bootstrapModalHandler.protocol=settings.protocol}modalSettings.callbacks=processCallback(settings);modalSettings.userSettings=settings;modalSettings.modalId=modalId;$(jq(modalSettings.modalId)).off("hidden.bs.modal");$(jq(modalSettings.modalId)).on("hidden.bs.modal",function(e){closeModal()})};var processCallback=function(settings){var callbacks={};if(ChargeBee._util.isUndefined(settings)){return callbacks}for(var i=0;i<allowedCallbacks.length;i++){if(ChargeBee._util.isFunction(settings[allowedCallbacks[i]])){callbacks[allowedCallbacks[i]]=settings[allowedCallbacks[i]]}}return callbacks};var validateModalId=function(modalId){if(typeof modalId==="undefined"){throw new Error("modal id is required parameter")}if(typeof $(jq(modalId))==="undefined"||$(jq(modalId)).length<1){throw new Error("element with id "+modalId+" is not present")}if(typeof $(jq(modalId)).find("[data-cb-modal-body]")==="undefined"||$(jq(modalId)).find("[data-cb-modal-body]").length!==1){throw new Error('modal body is not present. please add "data-cb-modal-body" attribute to your modal body')}};var validateRequired=function(){if(typeof jQuery==="undefined"||jQuery===null){throw new Error("this function is jQuery based. please include jQuery before using this")}};var jq=function(id){return"#"+id.replace(/(:|\[|\]|\.)/g,"\\$1")}}).call(window,window.ChargeBee);if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}())}).call(this);